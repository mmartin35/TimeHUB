<!DOCTYPE html>
<html lang="en">
    {% load static %}
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon">
    <head>
        <title>Planning</title>
        <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
        <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/interaction@6.1.15/index.global.min.js'></script>
        <script src='https://code.jquery.com/jquery-3.6.0.min.js'></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                var calendarEl = document.getElementById('calendar');
                var calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: 'dayGridMonth',
                    dateClick: function(info) {
                        document.getElementById('eventDate').value = info.dateStr;
                        document.getElementById('reason').focus();
                    },
                    events: "{% url 'events_json' %}",
                    eventDidMount: function(info) {
                        info.el.style.backgroundColor = info.event.backgroundColor;
                    }
                });
                calendar.render();
            });
        </script>
        <style>
            body {
                font-family: Arial, sans-serif;
                background-color: #fff;
                color: #000;
                margin: 0;
                padding: 0;
                display: flex;
                height: 100vh;
                overflow: hidden;
            }
            .menu {
                padding: 20px;
                text-align: left;
                width: 200px;
                border-right: 1px solid #000;
                height: 100vh;
                overflow-y: auto;
            }
            .menu a {
                display: block;
                margin: 10px 0;
                text-decoration: none;
                color: #000;
                font-size: 18px;
            }
            .menu a:hover {
                color: #555;
            }
            .content {
                display: flex;
                flex-direction: row;
                flex-grow: 1;
                padding: 20px;
                overflow: hidden;
                gap: 20px;
            }
            #calendar {
                flex: 1;
                min-width: 300px;
            }
            #eventFormSection {
                width: 300px;
                max-width: 100%;
                padding: 20px;
                border: 1px solid #888;
                border-radius: 4px;
                background-color: #f9f9f9;
            }
            form label {
                display: block;
                margin-top: 10px;
            }
            form input, form button {
                margin-top: 5px;
                width: 100%;
            }
            button {
                margin-top: 10px;
            }
        </style>
    </head>
    <body>
        <div class="menu">
            <strong> Logged as {{ name }}</strong>
            <a href="../">Home</a>
            <a href="../planning">Planning</a>
            <a href="../reporting">Reporting</a>
            <a href="../logout">Logout</a>
        </div>

        <div class="content">
            <div id='calendar'></div>
            <div id="eventFormSection">
                <h2>Create New Event</h2>
                <form id="eventForm" method="post">
                    {% csrf_token %}
                    <input type="hidden" id="eventDate" name="start_date">
                    <label for="reason">Reason:</label>
                    <input type="text" id="reason" name="reason" required><br>
                    <label for="start_date">Start Date:</label>
                    <input type="date" id="start_date" name="start_date" required><br>
                    <label for="end_date">End Date:</label>
                    <input type="date" id="end_date" name="end_date" required><br>
                    <label for="half_day_start">Start:</label>
                    <select id="half_day_start" name="half_day_start" required>
                        <option value="0">Starting in the morning</option>
                        <option value="1">Starting in the afternoon</option>
                    </select>
                    <label for="half_day_end">End:</label>
                    <select id="half_day_end" name="half_day_end" required>
                        <option value="0">Ending in the morning</option>
                        <option value="1">Ending in the afternoon</option>
                    </select>
                    <button type="submit">Submit</button>
                </form>
                <h2>Infos:</h2>
                <p>Days off remaining: {{ days_off_left }}</p>
                <p>Days off on hold: {{ days_off_onhold }}</p>
            </div>
        </div>
    </body>
</html>
